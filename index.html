<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>R-CODE NEON v14</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{--neon:#00ff9c;--panel:#0b0f14}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:Courier New,monospace;
  color:var(--neon);overflow:hidden;
}

/* ===== MATRIX CANVAS ===== */
#matrix{position:fixed;inset:0;z-index:0;background:#000}

/* ===== UI ===== */
.wrap{position:relative;z-index:2;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:10px}
.container{
  width:100%;max-width:580px;background:rgba(11,15,20,.85);
  backdrop-filter:blur(6px);border:1px solid var(--neon);
  border-radius:16px;padding:18px;box-shadow:0 0 25px rgba(0,255,156,.5)
}
h1{text-align:center;font-size:18px;margin:0 0 12px;text-shadow:0 0 8px var(--neon)}
label{font-size:12px;opacity:.8}
input,textarea,select{
  width:100%;background:#000;color:var(--neon);
  border:1px solid var(--neon);border-radius:10px;
  padding:10px;margin:6px 0 10px;font-size:14px
}
textarea{min-height:120px;resize:none}
.row{display:flex;gap:10px;align-items:center}
button{
  flex:1;padding:12px 0;background:#000;color:var(--neon);
  border:1px solid var(--neon);border-radius:12px;
  font-weight:bold;cursor:pointer;text-shadow:0 0 6px var(--neon)
}
button.small{flex:0.4}
.progress{width:100%;height:8px;background:#022;border-radius:6px;overflow:hidden;margin:6px 0 10px}
.bar{height:100%;width:0%;background:linear-gradient(90deg,#00ff9c,#00cfff);transition:width .15s}
footer{text-align:center;font-size:11px;opacity:.6;margin-top:10px}
</style>
</head>

<body>
<canvas id="matrix"></canvas>

<div class="wrap">
  <div class="container">
    <h1>üñ•Ô∏è R-CODE NEON v14</h1>

    <label>MASTER KEY</label>
    <div class="row">
      <input id="key">
      <button class="small" onclick="generateKey()">üé≤</button>
    </div>

    <label>EXPIRY (encode time)</label>
    <div class="row">
      <input id="expiryValue" type="number" min="0">
      <select id="expiryUnit">
        <option value="none">No Expiry</option>
        <option value="minutes">Minutes</option>
        <option value="hours">Hours</option>
        <option value="days">Days</option>
      </select>
    </div>

    <label>INPUT</label>
    <textarea id="input"></textarea>

    <div class="row">
      <button onclick="encode()">ENCODE</button>
      <button onclick="decode()">DECODE</button>
    </div>

    <div class="progress"><div class="bar" id="bar"></div></div>

    <label>OUTPUT</label>
    <textarea id="output" readonly></textarea>
    <button onclick="copyOutput()">üìã COPY</button>

    <footer>Matrix ‚Ä¢ JSON Control ‚Ä¢ Cache Safe</footer>
  </div>
</div>

<script>
/* ================= JSON CONTROL (HOSTING POWER) ================= */
const CONTROL_URL = "https://oxygen120.github.io/rcode-control/control.json";

async function checkControl(){
  try{
    const res = await fetch(CONTROL_URL + "?t=" + Date.now(), { cache:"no-store" });
    const c = await res.json();

    if(c.expiresAt && new Date() > new Date(c.expiresAt)){
      lockPage("‚è≥ ACCESS EXPIRED","This page is no longer available.");
      return;
    }
    if(c.enabled === false){
      lockPage("‚õî ACCESS REVOKED", c.message || "Blocked by owner");
      return;
    }
  }catch(e){
    lockPage("‚ö†Ô∏è CONTROL ERROR","Unable to verify access.");
  }
}

function lockPage(title,msg){
  document.body.innerHTML=`
    <div style="background:black;color:#00ff9c;font-family:monospace;
    height:100vh;display:flex;justify-content:center;align-items:center;text-align:center">
      <div><h1>${title}</h1><p>${msg}</p></div>
    </div>`;
}

checkControl();

/* ================= MATRIX ================= */
const canvas=document.getElementById("matrix"),ctx=canvas.getContext("2d");
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
resize();addEventListener("resize",resize);
const letters="01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éû„Éü„É†„É°„É¢„É©„É™„É´„É¨„É≠";
const fs=14;let cols=Math.floor(canvas.width/fs);
let drops=Array(cols).fill(1);
setInterval(()=>{
 ctx.fillStyle="rgba(0,0,0,.06)";ctx.fillRect(0,0,canvas.width,canvas.height);
 ctx.fillStyle="#00ff9c";ctx.font=fs+"px monospace";
 for(let i=0;i<drops.length;i++){
  const t=letters[Math.random()*letters.length|0];
  ctx.fillText(t,i*fs,drops[i]*fs);
  if(drops[i]*fs>canvas.height&&Math.random()>0.975)drops[i]=0;
  drops[i]++;
 }
},33);

/* ================= CRYPTO ================= */
const te=new TextEncoder(),td=new TextDecoder();
function hash32(s){let h=2166136261;for(let c of s){h^=c.charCodeAt(0);h=Math.imul(h,16777619)}return(h>>>0).toString(16)}
function xorBytes(d,k){const o=new Uint8Array(d.length);for(let i=0;i<d.length;i++)o[i]=d[i]^k[i%k.length];return o}
function toB64(b){return btoa(String.fromCharCode(...b))}
function fromB64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}
function expiryToMs(v,u){
 if(u==="none")return 0;const n=+v;if(!n||n<=0)return 0;
 if(u==="minutes")return n*6e4;
 if(u==="hours")return n*36e5;
 if(u==="days")return n*864e5;
 return 0;
}

/* Random key */
function generateKey(){
 const c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%!*";
 let k="";for(let i=0;i<16;i++)k+=c[Math.random()*c.length|0];
 key.value=k;navigator.clipboard.writeText(k);
 alert("üîë Random key generated & copied");
}

/* Terminal helpers */
function typeOut(txt,cb){
 output.value="";let i=0;
 const t=setInterval(()=>{output.value+=txt[i++]||"";if(i>txt.length){clearInterval(t);cb&&cb();}},20);
}
function runProgress(done){
 bar.style.width="0%";let p=0;
 const t=setInterval(()=>{p+=Math.random()*18;if(p>=100){p=100;clearInterval(t);done()}bar.style.width=p+"%"},120);
}

/* Encode */
function encode(){
 const k=key.value,txt=input.value;if(!k||!txt)return alert("Key & text required");
 let d=te.encode(txt),kb=te.encode(k);for(let i=0;i<1000;i++)d=xorBytes(d,kb);
 const token=hash32(k+toB64(d));
 const ms=expiryToMs(expiryValue.value,expiryUnit.value);
 const exp=ms?Date.now()+ms:0;
 output.value=btoa(token+"|"+exp+"|"+toB64(d));
}

/* Decode */
function decode(){
 const k=key.value,enc=input.value;if(!k||!enc)return alert("Key & encrypted text required");
 let raw;try{raw=atob(enc)}catch{return typeOut("Invalid data")}
 const p=raw.split("|");if(p.length!==3)return typeOut("Corrupted payload");
 const [token,exp,b64]=p;if(exp!=="0"&&Date.now()>+exp)return typeOut("‚è≥ MESSAGE EXPIRED");
 runProgress(()=>{
  let d=fromB64(b64),kb=te.encode(k);for(let i=0;i<1000;i++)d=xorBytes(d,kb);
  if(hash32(k+toB64(d))!==token)return typeOut("‚ùå WRONG KEY");
  typeOut(td.decode(d));
 });
}

/* Copy */
function copyOutput(){if(!output.value)return;navigator.clipboard.writeText(output.value);alert("Copied")}
</script>
</body>
</html>
