<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>R-CODE NEON v21</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{--neon:#00ff9c}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:Courier New,monospace;
  background:#000;color:var(--neon);overflow:hidden
}
#matrix{position:fixed;inset:0;z-index:0}
.wrap{position:relative;z-index:2;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:10px}
.container{
  width:100%;max-width:600px;
  background:rgba(10,15,20,.9);
  border:1px solid var(--neon);
  border-radius:16px;padding:18px;
  box-shadow:0 0 25px rgba(0,255,156,.5)
}
h1{text-align:center;font-size:18px;margin:0 0 12px}
label{font-size:12px;opacity:.8}
input,textarea,select,button{
  width:100%;background:#000;color:var(--neon);
  border:1px solid var(--neon);
  border-radius:10px;
  padding:10px;margin:6px 0;
  font-family:inherit
}
textarea{min-height:120px;resize:none}
.row{display:flex;gap:10px}
button{cursor:pointer;font-weight:bold}
button.small{flex:.4}
.progress{width:100%;height:8px;background:#022;border-radius:6px;overflow:hidden}
.bar{height:100%;width:0%;background:linear-gradient(90deg,#00ff9c,#00cfff)}
footer{text-align:center;font-size:11px;opacity:.6;margin-top:8px}
</style>
</head>

<body>
<canvas id="matrix"></canvas>

<div class="wrap">
<div class="container">
<h1>üñ•Ô∏è R-CODE NEON v21</h1>

<label>MASTER KEY</label>
<div class="row">
  <input id="key">
  <button class="small" onclick="generateKey()">üé≤</button>
</div>

<label>DEPTH LEVEL</label>
<input type="range" id="depth" min="1" max="3" value="2">
<div style="display:flex;justify-content:space-between;font-size:11px;opacity:.7">
  <span>Normal</span><span>Chaos</span><span>Extreme</span>
</div>

<label>EXPIRY</label>
<div class="row">
  <input id="expiryValue" type="number" min="0">
  <select id="expiryUnit">
    <option value="none">No Expiry</option>
    <option value="minutes">Minutes</option>
    <option value="hours">Hours</option>
    <option value="days">Days</option>
  </select>
</div>

<label>INPUT</label>
<textarea id="input"></textarea>

<div class="row">
  <button onclick="encode()">ENCODE</button>
  <button onclick="decode()">DECODE</button>
</div>

<div class="progress"><div class="bar" id="bar"></div></div>

<label>OUTPUT</label>
<textarea id="output" readonly></textarea>
<button onclick="copyOutput()">üìã COPY</button>

<footer>JSON Control ‚Ä¢ Fixed Alphabet ‚Ä¢ Chaos ‚Ä¢ v21</footer>
</div>
</div>

<script>
/* ========== JSON CONTROL ========== */
const CONTROL_URL = "https://oxygen120.github.io/rcode-control/control.json";
let CONTROL = { enabled:true, mode:"normal" };

fetch(CONTROL_URL + "?v=" + Date.now(), { cache:"no-store" })
 .then(r => { if(!r.ok) throw 0; return r.json(); })
 .then(j => CONTROL = j)
 .catch(()=>{});

/* ========== MATRIX ========== */
const canvas=document.getElementById("matrix"),ctx=canvas.getContext("2d");
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
resize();addEventListener("resize",resize);
const chars="01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ";
const fs=14;let drops=Array(Math.floor(innerWidth/fs)).fill(1);
setInterval(()=>{
 ctx.fillStyle="rgba(0,0,0,.06)";
 ctx.fillRect(0,0,canvas.width,canvas.height);
 ctx.fillStyle="#00ff9c";ctx.font=fs+"px monospace";
 for(let i=0;i<drops.length;i++){
  const t=chars[Math.random()*chars.length|0];
  ctx.fillText(t,i*fs,drops[i]*fs);
  if(drops[i]*fs>canvas.height&&Math.random()>0.98)drops[i]=0;
  drops[i]++;
 }
},33);

/* ========== CORE HELPERS ========== */
const te=new TextEncoder(),td=new TextDecoder();
function xorBytes(d,k){const o=new Uint8Array(d.length);for(let i=0;i<d.length;i++)o[i]=d[i]^k[i%k.length];return o}
function hash32(s){let h=2166136261;for(let c of s){h^=c.charCodeAt(0);h=Math.imul(h,16777619)}return(h>>>0).toString(16)}
function toB64(b){return btoa(String.fromCharCode(...b))}
function fromB64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}
function expiryToMs(v,u){
 if(u==="none")return 0;
 const n=+v;if(!n||n<=0)return 0;
 if(u==="minutes")return n*60000;
 if(u==="hours")return n*3600000;
 if(u==="days")return n*86400000;
 return 0;
}

/* ========== RANDOM KEY ========== */
function generateKey(){
 const c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%!*";
 let k="";for(let i=0;i<16;i++)k+=c[Math.random()*c.length|0];
 key.value=k;navigator.clipboard.writeText(k);
}

/* ========== FIXED SUBSTITUTION ========== */
const SUB_PLAIN="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const SUB_CIPHER="LZFQWERTYUIOPASDGHJKMNBVCX";
const ENC={},DEC={};
for(let i=0;i<26;i++){ENC[SUB_PLAIN[i]]=SUB_CIPHER[i];DEC[SUB_CIPHER[i]]=SUB_PLAIN[i];}
const subEnc=t=>t.replace(/[A-Za-z]/g,c=>{const u=c.toUpperCase();if(!ENC[u])return c;const r=ENC[u];return c===u?r:r.toLowerCase()});
const subDec=t=>t.replace(/[A-Za-z]/g,c=>{const u=c.toUpperCase();if(!DEC[u])return c;const r=DEC[u];return c===u?r:r.toLowerCase()});

/* ========== CORE ENCRYPTION ========== */
function coreEncode(k,t,ms){
 let d=te.encode(t),kb=te.encode(k);
 for(let i=0;i<800;i++)d=xorBytes(d,kb);
 const p=toB64(d),tok=hash32(k+p).slice(0,8);
 const exp=ms?Date.now()+ms:0;
 return `RC14::${exp}::${p}::${tok}`;
}
function coreDecode(k,e){
 if(!e.startsWith("RC14::"))return null;
 const p=e.split("::");if(p.length!==4)return null;
 const [,exp,pay,tok]=p;
 if(exp!=="0"&&Date.now()>+exp)return null;
 let d;try{d=fromB64(pay)}catch{return null}
 const kb=te.encode(k);
 for(let i=0;i<800;i++)d=xorBytes(d,kb);
 if(hash32(k+pay).slice(0,8)!==tok)return null;
 return td.decode(d);
}

/* ========== OUTER CHAOS ========== */
const outerEnc=s=>"Œ©X::"+s.split("").map(c=>(c.charCodeAt(0)+18).toString(36)).join(".");
const outerDec=s=>{
 if(!s.startsWith("Œ©X::"))return null;
 let o="";for(let p of s.slice(4).split(".")){const n=parseInt(p,36);if(isNaN(n))return null;o+=String.fromCharCode(n-18)}
 return o;
};

/* ========== FLOW ========== */
function encode(){
 if(!CONTROL.enabled) return alert("SYSTEM DISABLED BY ADMIN");
 const k=key.value,txt=input.value;
 if(!k||!txt)return alert("Key & text required");
 let stage=subEnc(txt);
 let out=coreEncode(k,stage,expiryToMs(expiryValue.value,expiryUnit.value));
 if(depth.value>=2)out=outerEnc(out);
 if(depth.value>=3)out=outerEnc(out);
 output.value=out;
}
function decode(){
 if(!CONTROL.enabled) return typeOut("üö´ SYSTEM DISABLED");
 if(CONTROL.mode==="seized") return typeOut("‚ö†Ô∏è SYSTEM SEIZED");
 const k=key.value,enc=input.value;
 if(!k||!enc)return alert("Key & data required");
 let cur=enc;
 for(let i=0;i<2;i++){const t=outerDec(cur);if(t)cur=t}
 const r=coreDecode(k,cur);
 r?typeOut(subDec(r)):typeOut("‚ùå DECODE FAILED");
}
function typeOut(t){output.value="";let i=0;const x=setInterval(()=>{output.value+=t[i++]||"";if(i>t.length)clearInterval(x)},18)}
function copyOutput(){if(output.value)navigator.clipboard.writeText(output.value)}
</script>
</body>
</html>